# Autonomous Driving Vision System Configuration
# TurtleBot3 Burger with Raspberry Pi Camera (Wide)

# =============================================================================
# Camera Settings
# =============================================================================
camera:
  width: 640
  height: 480
  fps: 30
  image_topic: "/camera/image_raw/compressed"
  camera_info_topic: "/camera/camera_info"

# =============================================================================
# Network Settings (MacBook <-> TurtleBot)
# =============================================================================
network:
  turtlebot_ip: "192.168.0.18"
  ros_domain_id: 17
  stream_port: 8080

# =============================================================================
# Person Detection Settings (YOLOv8)
# =============================================================================
person_detection:
  model: "yolov8n.pt"
  confidence_threshold: 0.5
  person_class_id: 0
  danger_zone_ratio: 0.4
  caution_zone_ratio: 0.25

# =============================================================================
# Lane Detection Settings (for yellow lane following)
# =============================================================================
lane_detection:
  roi:
    top_ratio: 0.5     # Process bottom half of image
    bottom_ratio: 1.0
    left_ratio: 0.0
    right_ratio: 1.0

  # Yellow lane (PRIMARY - main lane to follow)
  yellow_tape:
    h_low: 15          # Wider range for yellow detection
    s_low: 80          # Lower saturation threshold
    v_low: 80          # Lower value threshold for darker yellows
    h_high: 40         # Include yellow-orange
    s_high: 255
    v_high: 255

  white_tape:
    h_low: 0
    s_low: 0
    v_low: 180         # Lower from 200 for better low-light detection
    h_high: 180
    s_high: 35         # Increase from 30 to catch slightly colored white tape
    v_high: 255

  # Black lane (PRIMARY - follow black lane curvature)
  black_line:
    h_low: 0
    h_high: 180
    s_low: 0
    s_high: 255
    v_low: 0
    v_high: 70         # Detects dark/black lines (slightly increased for better detection)

  blue_tape:
    h_low: 100
    s_low: 100
    v_low: 100
    h_high: 130
    s_high: 255
    v_high: 255

  canny:
    low_threshold: 50
    high_threshold: 150

  hough:
    rho: 2
    theta_degrees: 1
    threshold: 25       # Lower threshold for curved black lane
    min_line_length: 30 # Shorter segments for curves
    max_line_gap: 150   # Larger gap to connect curved segments

# =============================================================================
# Boundary Platform Detection Settings (DISABLED - only follow black lane)
# =============================================================================
boundary_detection:
  enabled: false
  roi:
    top_ratio: 0.6      # Bottom 40% of frame
    bottom_ratio: 1.0

  black_platform:
    h_low: 0
    h_high: 180
    s_low: 0
    s_high: 255
    v_low: 0
    v_high: 50

  # Zone division (0.33 = 33% from left)
  left_zone_boundary: 0.33
  right_zone_boundary: 0.67

  # Coverage thresholds
  block_threshold: 0.3           # 30% coverage = zone blocked
  full_block_threshold: 0.8      # 80% all zones = completely blocked

  # Avoidance strength (0.0 to 1.0)
  avoidance_strength: 0.6

# =============================================================================
# Traffic Sign and Light Detection Settings (YOLOv8 Fine-tuned)
# =============================================================================
traffic_sign_light:
  model: "traffic_sign_lights.pt"
  confidence_threshold: 0.5
  # Model detects: stop sign, traffic lights (red/yellow/green),
  # road signs (bump, no parking, speed limits, etc.)

# =============================================================================
# Decision Making Settings
# =============================================================================
decision:
  priorities:
    pedestrian: 4       # Highest - safety first
    boundary: 3         # Boundary platform avoidance
    traffic_light: 2    # Disabled in code (no traffic lights on track)
    lane_following: 1   # Primary mode

  lane_pid:
    kp: 0.008          # Increased for better curve following
    ki: 0.0002
    kd: 0.002

  max_steering_angle: 0.8  # Increased for sharper curves

# =============================================================================
# TurtleBot3 Control Settings (MINIMUM VELOCITY)
# =============================================================================
turtlebot:
  max_linear_velocity: 0.08
  max_angular_velocity: 1.5
  normal_speed: 0.06      # Minimum velocity for black lane following
  slow_speed: 0.05
  cmd_vel_topic: "/cmd_vel"
  emergency_stop_distance: 0.3

# =============================================================================
# Visualization Settings
# =============================================================================
visualization:
  show_windows: true
  show_fps: true
  show_detections: true
  show_lanes: true
  show_traffic_lights: true
  record_video: true
  output_path: "/home/turtlebot/vision360/records"
